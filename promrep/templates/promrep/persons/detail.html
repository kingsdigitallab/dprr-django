{% extends "base.html" %}
{% load wagtailbase_tags %}

{% block meta_title %}Person Details{% endblock %}

{% block main %}

<div class="row">
    <div class="large-12 columns">
        <h2>{{ person.dprr_id }} {{ person }}</h2>

        {% if person.review_flag %}
        <p><strong>Warning: person needs revision</strong></p>
        {% endif %}

        {% if person.has_status_information %}
        <ul class="timeline no-bullet">
            {% include "promrep/persons/status.html" with title="Patrician" status=person.patrician uncertain=person.patrician_uncertain notes=person.patrician_notes %}
            {% include "promrep/persons/status.html" with title="Nobilis" status=person.nobilis uncertain=person.nobilis_uncertain notes=person.nobilis_notes %}
            {% include "promrep/persons/status.html" with title="Novus" status=person.novus uncertain=person.novus_uncertain notes=person.novus_notes %}

            {% with eques=person.get_eques_status_assertion %}
            {% include "promrep/persons/status.html" with title="Eques" status=eques uncertain=eques.uncertain notes=eques.notes %}
            {% endwith %}
        </ul>
        {% endif %}

        {% if person.dateinformation_set.all %}
        <h3>Life Dates</h3>
        <ul class="timeline no-bullet">
            {% for di in person.dateinformation_set.all %}
            <li>{{ di }}
                {% if di.notes %}
                <a href="#" class="expander life-dates right">Expand <i class="fa fa-caret-right"></i></a>
                <p class="hide collapsible">{{ di.notes|capfirst }}</p>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
        {% endif %}

        {% include "promrep/persons/relationships.html" %}

        <h3>Career</h3>
        <ul class="timeline no-bullet">
            {% for pa in person.post_assertions.all %}
            <li><span class="{% if pa.uncertain %}gray{% else %}green{% endif %}">{{ pa.print_date | safe }}</span> <strong>{{ pa.office | title }}</strong> {% if pa.provinces %}{{ pa.print_provinces }}{% endif %}
                {% if pa.notes.count %}
                <a href="#" class="expander right">Expand <i class="fa fa-caret-right"></i></a>
                <ul class="no-bullet hide collapsible">
                    {% for note in pa.notes.all %}
                    <li>{{ note.text }} (in <em>{{ note.secondary_source.abbrev_name }}</em>)</li>
                    {% endfor %}
                </ul>
                {% endif %}

            </li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}
